<h1 class="page-title">üìù All Articles</h1>

<style>
.user-avatar-link {
  text-decoration: none;
}

.user-avatar {
  width: 35px;
  height: 35px;
  border-radius: 50%;
  background: linear-gradient(135deg, #36d1dc, #5b86e5);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  font-size: 16px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.user-avatar:hover {
  transform: scale(1.1);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.see-more {
  color: #5b86e5;
  font-weight: bold;
  cursor: pointer;
  text-decoration: underline;
}
</style>

<div class="articles-grid">
  <% @articles.each do |article| %>
    <div class="article-card">

      <!-- User Info -->
      <% if article.user %>
        <div class="user-info">
          <%= link_to user_path(article.user), class: "user-avatar-link" do %>
            <div class="user-avatar"><%= article.user.name[0].upcase %></div>
          <% end %>
          <%= link_to article.user.name, user_path(article.user), class: "user-link" %>
        </div>
      <% end %>

      <!-- Article Content -->
      <div class="article-content">
        <h2 class="article-title"><%= article.name %></h2>

        <%# Update truncation logic for 25 words %>
        <% description_text = article.description.to_s.strip %>
        <% words = description_text.split(/\s+/) %>
        <p class="article-desc">
          <%= words.first(25).join(" ") %>
          <% if words.size > 25 %>
            <%= link_to " See more", article_path(article), class: "see-more" %>
          <% end %>
        </p>
      </div>

      <!-- Actions -->
      <div class="article-actions">
        <%= link_to "üëÅ Show", article_path(article), class: "action-link show-link" %>
        <% if logged_in? && article.user == current_user %>
          <div>
            <%= link_to "‚úèÔ∏è Edit", edit_article_path(article), class: "action-link edit-link" %>
            <%= link_to "üóë Delete", article_path(article), 
                        data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, 
                        class: "action-link delete-link" %>
          </div>
        <% end %>
      </div>

    </div>
  <% end %>
</div>

<!-- Pagination -->
<div class="pagination-container">
  <%= will_paginate @articles %>
</div>

<!-- New Article Button -->
<div class="new-article-btn">
  <% if logged_in? %>
    <%= link_to "‚ûï New Article", new_article_path, class: "new-article-link" %>
  <% else %>
    <%= link_to "Login Here", login_path, 
        style: "display:inline-block; padding:12px 30px; 
                background: linear-gradient(135deg, #36d1dc, #5b86e5); 
                color:white; font-weight:bold; font-size:18px; 
                border-radius:30px; text-decoration:none; 
                box-shadow:0 6px 18px rgba(0,0,0,0.2); 
                transition:all 0.3s ease;" %>
  <% end %>
</div>